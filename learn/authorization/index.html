<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><title>인증 | GraphQL</title><meta name="viewport" content="width=640"/><meta property="og:title" content="GraphQL: A query language for APIs."/><meta property="og:description" content="GraphQL provides a complete description of the data in your API, gives clients the power to ask for exactly what they need and nothing more, makes it easier to evolve APIs over time, and enables powerful developer tools."/><meta property="og:type" content="website"/><meta property="og:url" content="http://graphql.org/"/><meta property="og:image" content="/img/og_image.png"/><meta property="og:image:type" content="image/png"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@graphql"/><meta name="twitter:title" content="GraphQL: A query language for APIs."/><meta name="twitter:description" content="GraphQL gives clients the power to ask for exactly what they need and nothing more, making it easier to evolve APIs over time."/><meta name="twitter:image" content="/img/twitter_image.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="home" type="application/rss+xml" href="/blog/rss.xml" title="GraphQL Team Blog"/><link rel="stylesheet" href="/style.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:300|Roboto:300"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,400i,600"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/></head><body><header><section><a class="nav-home" href="/"><img class="nav-logo" src="/img/logo.svg" width="30" height="30"/>GraphQL</a><nav><a href="/learn/">배우기</a><a href="/code/">코드</a><a href="/community/">커뮤니티</a><a href="/blog/">블로그</a><a href="http://facebook.github.io/graphql/" target="_blank" rel="noopener noreferrer">명세</a></nav><div class="algolia-search-wrapper"><input type="text" id="algolia-search-input" placeholder="Search docs..."/></div></section></header><section><div class="documentationContent"><div class="inner-content"><h1>인증</h1><div><blockquote><p>비즈니스 로직 레이어에 인증 로직을 위임하세요</p></blockquote><p>인증은 주어진 사용자/세션/컨텍스트가 작업을 수행하거나 데이터를 볼 수 있는 권한이 있는지 여부를 나타내는 비즈니스 로직입니다. 예를 들어,</p><ul><li>&quot;저자만 게시글을 볼 수 있음&quot;</li></ul><p>이런 종류의 행동을 강요하는 것은 <a href="/learn/thinking-in-graphs/#business-logic-layer">비즈니스 로직 레이어</a>에서 일어나야합니다. GraphQL 레이어에 다음과 같이 인증 로직을 배치해야합니다.</p><pre class="prism language-javascript"><span class="keyword">var</span> postType <span class="operator">=</span> <span class="keyword">new</span> <span class="class-name">GraphQLObjectType</span><span class="punctuation">(</span><span class="punctuation">{</span>
  name<span class="punctuation">:</span> ‘Post’<span class="punctuation">,</span>
  fields<span class="punctuation">:</span> <span class="punctuation">{</span>
    body<span class="punctuation">:</span> <span class="punctuation">{</span>
      type<span class="punctuation">:</span> GraphQLString<span class="punctuation">,</span>
      resolve<span class="punctuation">:</span> <span class="punctuation">(</span>post<span class="punctuation">,</span> args<span class="punctuation">,</span> context<span class="punctuation">,</span> <span class="punctuation">{</span> rootValue <span class="punctuation">}</span><span class="punctuation">)</span> <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">{</span>
        <span spellcheck="true" class="comment">// return the post body only if the user is the post&#x27;s author</span>
        <span class="keyword">if</span> <span class="punctuation">(</span>context<span class="punctuation">.</span>user <span class="operator">&amp;&amp;</span> <span class="punctuation">(</span>context<span class="punctuation">.</span>user<span class="punctuation">.</span>id <span class="operator">===</span> post<span class="punctuation">.</span>authorId<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="keyword">return</span> post<span class="punctuation">.</span>body<span class="punctuation">;</span>
        <span class="punctuation">}</span>
        <span class="keyword">return</span> <span class="keyword">null</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span></pre><p>게시물의 <code>authorId</code> 필드가 현재 사용자의 <code>id</code> 와 같은지 확인하여 &quot;저자가 게시물을 소유&quot; 한다고 정의합니다. 이렇게하면 문제가 무엇일까요? 각 코드를 서비스의 각 진입점에 복사해야합니다. 인증 로직이 완벽하게 동기화되지 않는 경우 사용자는 사용하는 API에 따라 다른 데이터를 보게될 수 있습니다. <a href="/learn/thinking-in-graphs/#business-logic-layer">단일 소스(single source of truth)</a> 인증을 통해 이것을 회피할 수 있습니다.</p><p>GraphQL이나 프로토타이핑을 배울 때 <em>resolver</em> 내부에 인증 로직을 정의하는 것이 좋습니다. 그러나 프로덕션 코드의 경우 비즈니스 로직 레이어에 인증 로직을 위임하세요. 다음은 그 예입니다.</p><pre class="prism language-javascript"><span spellcheck="true" class="comment">// 인증 로직은 postRepository 내부에 있습니다.</span>
<span class="keyword">var</span> postRepository <span class="operator">=</span> <span class="function">require</span><span class="punctuation">(</span><span class="string">&#x27;postRepository&#x27;</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="keyword">var</span> postType <span class="operator">=</span> <span class="keyword">new</span> <span class="class-name">GraphQLObjectType</span><span class="punctuation">(</span><span class="punctuation">{</span>
  name<span class="punctuation">:</span> ‘Post’<span class="punctuation">,</span>
  fields<span class="punctuation">:</span> <span class="punctuation">{</span>
    body<span class="punctuation">:</span> <span class="punctuation">{</span>
      type<span class="punctuation">:</span> GraphQLString<span class="punctuation">,</span>
      resolve<span class="punctuation">:</span> <span class="punctuation">(</span>post<span class="punctuation">,</span> args<span class="punctuation">,</span> context<span class="punctuation">,</span> <span class="punctuation">{</span> rootValue <span class="punctuation">}</span><span class="punctuation">)</span> <span class="operator">=</span><span class="operator">&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">return</span> postRepository<span class="punctuation">.</span><span class="function">getBody</span><span class="punctuation">(</span>context<span class="punctuation">.</span>user<span class="punctuation">,</span> post<span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span></pre><p>위의 예에서 비즈니스 로직 레이어는 호출자가 <code>user</code> 객체를 제공해야 한다는 것을 알 수 있습니다. GraphQL.js를 사용하는 경우, <code>user</code> 객체는 <code>context</code> 인수 또는 <em>resolver</em> 의 네 번째 인수인 <code>rootValue</code> 에 전달되어져야 합니다.</p><p>불투명한 토큰이나 API key 대신 완전한 <code>user</code> 객체를 비즈니스 로직 레이어에 전달하는 것이 좋습니다. 이렇게하면 요청 처리 파이프라인의 여러 단계에서 <a href="/graphql-js/authentication-and-express-middleware/">인증</a> 문제를 처리 할 수 ​​있습니다.</p></div><a class="read-next" href="/learn/pagination"><span class="read-next-continue">계속 읽기 →</span><span class="read-next-title">Pagination</span></a></div><div class="nav-docs"><div><h3>배우기</h3><ul><li><a style="margin-left:0;" class="active" href="/learn/">소개</a></li></ul></div><div><h3>Learn</h3><ul><li><a style="margin-left:0;" class="active" href="/learn/queries/">쿼리 &amp; 뮤테이션</a><ul><li><a href="/learn/queries/#fields">Fields</a></li><li><a href="/learn/queries/#arguments">Arguments</a></li><li><a href="/learn/queries/#aliases">Aliases</a></li><li><a href="/learn/queries/#fragments">Fragments</a></li><li><a href="/learn/queries/#operation-name">Operation Name</a></li><li><a href="/learn/queries/#variables">Variables</a></li><li><a href="/learn/queries/#directives">Directives</a></li><li><a href="/learn/queries/#mutations">Mutations</a></li><li><a href="/learn/queries/#inline-fragments">Inline Fragments</a></li></ul></li><li><a style="margin-left:0;" class="active" href="/learn/schema/">스키마 &amp; 타입</a><ul><li><a href="/learn/schema/#type-system">Type System</a></li><li><a href="/learn/schema/#type-language">Type Language</a></li><li><a href="/learn/schema/#object-types-and-fields">Object Types and Fields</a></li><li><a href="/learn/schema/#arguments">Arguments</a></li><li><a href="/learn/schema/#the-query-and-mutation-types">The Query and Mutation Types</a></li><li><a href="/learn/schema/#scalar-types">Scalar Types</a></li><li><a href="/learn/schema/#enumeration-types">Enumeration Types</a></li><li><a href="/learn/schema/#lists-and-non-null">Lists and Non-Null</a></li><li><a href="/learn/schema/#interfaces">Interfaces</a></li><li><a href="/learn/schema/#union-types">Union Types</a></li><li><a href="/learn/schema/#input-types">Input Types</a></li></ul></li><li><a style="margin-left:0;" class="active" href="/learn/validation/">검사</a></li><li><a style="margin-left:0;" class="active" href="/learn/execution/">실행</a></li><li><a style="margin-left:0;" class="active" href="/learn/introspection/">복원</a></li></ul></div><div><h3>Best Practices</h3><ul><li><a style="margin-left:0;" class="active" href="/learn/best-practices/">소개</a></li><li><a style="margin-left:0;" class="active" href="/learn/thinking-in-graphs/">그래프로 생각하기</a></li><li><a style="margin-left:0;" class="active" href="/learn/serving-over-http/">HTTP를 통한 서빙</a></li><li><a style="margin-left:0;" class="active" href="/learn/authorization/">인증</a></li><li><a style="margin-left:0;" class="active" href="/learn/pagination/">Pagination</a></li><li><a style="margin-left:0;" class="active" href="/learn/caching/">Caching</a></li></ul></div></div></div></section><footer><section class="sitemap"><a href="/" class="nav-home"></a><div><h5><a href="/learn/">배우기</a></h5><a href="/learn/">소개</a><a href="/learn/queries/">쿼리 언어</a><a href="/learn/schema/">타입 시스템</a><a href="/learn/execution/">실행</a><a href="/learn/best-practices/">모범 사례</a></div><div><h5><a href="/code">코드</a></h5><a href="/code/#server-libraries">서버</a><a href="/code/#graphql-clients">클라이언트</a><a href="/code/#tools">도구</a></div><div><h5><a href="/community">커뮤니티</a></h5><a href="/community/upcoming-events/">이벤트</a><a href="http://stackoverflow.com/questions/tagged/graphql" target="_blank" rel="noopener noreferrer">스택 오버플로우</a><a href="https://www.facebook.com/groups/graphql.community/" target="_blank" rel="noopener noreferrer">페이스북 그룹</a><a href="https://twitter.com/GraphQL" target="_blank" rel="noopener noreferrer">트위터</a></div><div><h5>기타</h5><a href="/blog">GraphQL 팀 블로그</a><a href="http://facebook.github.io/graphql/" target="_blank" rel="noopener noreferrer">명세</a><a href="https://github.com/graphql" target="_blank" rel="noopener noreferrer">깃허브</a><a href="https://github.com/graphql/graphql.github.io/edit/source/site/learn/BestPractice-Authorization.md" target="_blank" rel="noopener noreferrer">이 페이지 수정 ✎</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noopener noreferrer" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright ©<span><script>document.write(new Date().getFullYear())</script> </span><noscript>2017 </noscript>Facebook Inc. The contents of this page are licensed BSD-3-Clause.</section></footer><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
        docsearch({
          apiKey: 'd103541f3e6041148aade2e746ed4d61',
          indexName: 'graphql',
          inputSelector: '#algolia-search-input'
        });
      </script><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-44373548-16', 'auto');
ga('send', 'pageview');
      </script></body></html>